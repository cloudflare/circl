// +build amd64

// Package ecdh provides the implementation of Elliptic-Curve Diffie-Hellman
// based on Curve25519 and Curve448.
package ecdh

import (
	"github.com/cloudflare/circl/ecdh/internal/field"
)

type xcurve struct {
	size       int                         // Size in bytes of prime field elements
	n          int                         // Size in bits of the prime field
	h          int                         // Cofactor of the elliptic curve group
	table      []byte                      // Precomputed multiples of the generator point
	xCoord     int                         // The x-coordinate of the generator point
	pointS     []byte                      // The x-coord of a point of order four
	pointGS    []byte                      // The x-coord of the generator point minus the point S
	ladderStep func([]byte, uint)          // Differential addition and doubling
	double     func([]byte)                // Point doubling
	difadd     func([]byte, []byte, uint)  // Differential point addition
	toAffine   func([]byte, []byte) []byte // Recovers the affine x-coord of the point (X:Z)
}

// Coordinates of points according to ia.cr/2017/264
var (
	pointS255  = field.Element255{1}
	pointGS255 = field.Element255{0xbd, 0xaa, 0x2f, 0xc8, 0xfe, 0xe1, 0x94, 0x7e, 0xf8, 0xed, 0xb2, 0x14, 0xae, 0x95, 0xf0, 0xbb, 0xe2, 0x48, 0x5d, 0x23, 0xb9, 0xa0, 0xc7, 0xad, 0x34, 0xab, 0x7c, 0xe2, 0xee, 0xcd, 0xae, 0x1e}
	pointS448  = field.Element448{0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff}
	pointGS448 = field.Element448{0x20, 0x27, 0x9d, 0xc9, 0x7d, 0x19, 0xb1, 0xac, 0xf8, 0xba, 0x69, 0x1c, 0xff, 0x33, 0xac, 0x23, 0x51, 0x1b, 0xce, 0x3a, 0x64, 0x65, 0xbd, 0xf1, 0x23, 0xf8, 0xc1, 0x84, 0x9d, 0x45, 0x54, 0x29, 0x67, 0xb9, 0x81, 0x1c, 0x3, 0xd1, 0xcd, 0xda, 0x7b, 0xeb, 0xff, 0x1a, 0x88, 0x3, 0xcf, 0x3a, 0x42, 0x44, 0x32, 0x1, 0x25, 0xb7, 0xfa, 0xf0}
)

var x255, x448 xcurve
